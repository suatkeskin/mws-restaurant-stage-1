"use strict";var restaurants=void 0,neighborhoods=void 0,cuisines=void 0,map=void 0,markers=[];document.addEventListener("DOMContentLoaded",function(){fetchNeighborhoods(),fetchCuisines()});var fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,t){if(e)console.error(e);else{self.neighborhoods=t,fillNeighborhoodsHTML();var n=document.getElementById("neighborhood"),r=document.querySelector(".neighborhood-listbox");new ComboBox(n,r)}})},fillNeighborhoodsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,n=document.getElementById("neighborhoods-select");e.forEach(function(e){var t=document.createElement("li");t.innerHTML=e,t.value=e,t.setAttribute("role","option"),n.append(t)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,t){if(e)console.error(e);else{self.cuisines=t,fillCuisinesHTML();var n=document.getElementById("cuisine"),r=document.getElementById("cuisine-listbox");new ComboBox(n,r)}})},fillCuisinesHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.cuisines,n=document.getElementById("cuisines-select");e.forEach(function(e){var t=document.createElement("li");t.innerHTML=e,t.value=e,t.setAttribute("role","option"),n.append(t)})};window.initMap=function(){self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),google.maps.event.addListener(self.map,"tilesloaded",function(){document.querySelectorAll("#map iframe").forEach(function(e){e.setAttribute("title","Google Maps")}),document.querySelectorAll("#map *").forEach(function(e){e.setAttribute("tabindex","-1")}),document.querySelectorAll('#map [rel="noopener"]').forEach(function(e){e.removeAttribute("rel")})}),updateRestaurants()};var updateRestaurants=function(){var e=document.getElementById("cuisine"),t=document.getElementById("neighborhood");DBHelper.fetchRestaurantByCuisineAndNeighborhood(e.value,t.value,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))}),addMarkersToMap()},createRestaurantHTML=function(e){var t=document.createElement("li"),n=DBHelper.imageUrlForRestaurant(e);if(n){var r=document.createElement("picture"),o=document.createElement("source");o.type="image/webp",o.srcset=DBHelper.webpSrcsetForRestaurant(e);var a=document.createElement("source");a.type="image/jpeg",a.srcset=DBHelper.imageSrcsetForRestaurant(e);var s=document.createElement("img");s.className="restaurant-img",s.src=n,s.srcset=DBHelper.imageSrcsetForRestaurant(e),s.sizes="100vw",s.alt="Image of restaurant "+e.name,r.appendChild(o),r.appendChild(a),r.appendChild(s),t.append(r)}var i=document.createElement("h3");i.innerHTML=e.name,t.append(i);var l=document.createElement("p");l.innerHTML=e.neighborhood,t.append(l);var u=document.createElement("p");u.innerHTML=e.address,t.append(u);var c=document.createElement("a");return c.innerHTML="View Details",c.href=DBHelper.urlForRestaurant(e),t.append(c),t},addMarkersToMap=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",function(){window.location.href=t.url}),self.markers.push(t)})};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInJlc3RhdXJhbnRzIiwibmVpZ2hib3Job29kcyIsImN1aXNpbmVzIiwibWFwIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZmV0Y2hOZWlnaGJvcmhvb2RzIiwiZmV0Y2hDdWlzaW5lcyIsIkRCSGVscGVyIiwiZXJyb3IiLCJjb25zb2xlIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwibmVpZ2hib3Job29kIiwiZ2V0RWxlbWVudEJ5SWQiLCJxdWVyeVNlbGVjdG9yIiwiQ29tYm9Cb3giLCJuZWlnaGJvcmhvb2RMaXN0Qm94IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwic2VsZiIsInVsIiwiZm9yRWFjaCIsImxpIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsImFwcGVuZCIsImZpbGxDdWlzaW5lc0hUTUwiLCJjdWlzaW5lIiwiY3Vpc2luZUxpc3RCb3giLCJ2YWx1ZSIsInNldEF0dHJpYnV0ZSIsImdvb2dsZSIsIm1hcHMiLCJNYXAiLCJ6b29tIiwiY2VudGVyIiwic2Nyb2xsd2hlZWwiLCJ3aW5kb3ciLCJpbml0TWFwIiwiYWRkTGlzdGVuZXIiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaXRlbSIsImxhdCIsImxvYyIsInJlbW92ZUF0dHJpYnV0ZSIsInVwZGF0ZVJlc3RhdXJhbnRzIiwicmVzZXRSZXN0YXVyYW50cyIsImZpbGxSZXN0YXVyYW50c0hUTUwiLCJtYXJrZXJzIiwibSIsInNldE1hcCIsInJlc3RhdXJhbnQiLCJhZGRNYXJrZXJzVG9NYXAiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsImltYWdlVXJsRm9yUmVzdGF1cmFudCIsImltZ1NyYyIsIndlYnAiLCJ0eXBlIiwiaW1nIiwic3Jjc2V0IiwiaW1hZ2VTcmNzZXRGb3JSZXN0YXVyYW50IiwiaW1hZ2UiLCJzcmMiLCJwaWN0dXJlIiwibmFtZSIsInNpemVzIiwiYWRkcmVzcyIsImFwcGVuZENoaWxkIiwibW9yZSIsImhyZWYiLCJ1cmxGb3JSZXN0YXVyYW50IiwibWFya2VyIiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsInVybCIsInB1c2giXSwibWFwcGluZ3MiOiJhQUFBLElBQUlBLGlCQUFBQSxFQUFhQyxtQkFBQUEsRUFBZUMsY0FBQUEsRUFDNUJDLFNBQUFBLEVBREFILFFBQUFBLEdBT0pJLFNBQVNDLGlCQUFpQixtQkFBb0IsV0FIOUNDLHFCQUtDQyxrQkFNRCxJQUFJRCxtQkFBcUIsV0FIekJFLFNBQUFGLG1CQUFBLFNBQUFHLEVBQUFSLEdBS0UsR0FBSVEsRUFDSEMsUUFBUUQsTUFBTUEsT0FIYkgsQ0FDSEUsS0FBQUEsY0FBU0YsRUFDUkssd0JBQWEsSUFBQUMsRUFBQVIsU0FBQVMsZUFBQSxnQkFDWkgsRUFBQU4sU0FBQVUsY0FBQSx5QkFERCxJQUFBQyxTQUVPSCxFQUFBSSxPQUpUTCxzQkFBQSxXQUFBLElBQUFWLEVBQUEsRUFBQWdCLFVBQUFDLGFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFBRyxLQUFBbkIsY0FrQk9vQixFQUFLakIsU0FBU1MsZUFBZSx3QkFKcENaLEVBQUFxQixRQUFBLFNBQUFWLEdBTUUsSUFBTVcsRUFBS25CLFNBQVNvQixjQUFjLE1BQ2xDRCxFQUFHRSxVQUFZYixFQUpqQlcsRUFBSVosTUFBQUEsRUFBZ0VZLEVBQXZDdEIsYUFBdUMsT0FBQSxVQU9sRW9CLEVBQUdLLE9BQU9ILE1BQVZGLGNBQUEsV0FDQWIsU0FOREQsY0FBQSxTQUFBRSxFQUFBUCxHQUZELEdBQUFPLEVBaUJHQyxRQUFRRCxNQUFNQSxPQU5qQixDQVFHVyxLQUFLbEIsU0FBV0EsRUFDaEJ5QixtQkFOSCxJQUFJcEIsRUFBQUEsU0FBZ0JNLGVBQWhCTixXQUNIQyxFQUF1QkosU0FBQVMsZUFBUVgsbUJBQzlCLElBQUlPLFNBQU9tQixFQUFBQyxPQU9WRixpQkFBQSxXQUFBLElBQUF6QixFQUFBLEVBQUFlLFVBQUFDLGFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFzQlksS0FBdEIzQixTQUNB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QWUsUUFDQUgsRUFBQUEsT0FBUUksR0FFUjdDLElBQUdHLEVBQU9zQyxTQUFWeEMsY0FBQSxLQUtERCxPQUpDOEMsRUFBQTVDLFVBQUEsZUFnQkQ0QyxFQUFLQyxLQUFPOUQsU0FBUytELGlCQUFpQm5CLEdBZHRDN0IsRUFBQUcsT0FBTXVDLEdBRUh2QyxHQU1IMkIsZ0JBQWdCakQsWUFBaEIsRUFBQWEsVUFBQUMsYUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQWdCRyxLQUFoQnBCLGFBQ1F5QixRQUFZMkIsU0FBQUEsR0FpQm5CLElBQU1vQixFQUFTaEUsU0FBU2lFLHVCQUF1QnJCLEVBQVloQyxLQUFLakIsS0FkakU2QixPQUFNcUMsS0FBT2pFLE1BQUFBLFlBQVNvQixFQUF0QixRQUFBLFdBQ0E2QyxPQUFLNUMsU0FBWTZDLEtBQUFFLEVBQWpCRSxNQUVBbkQsS0FBR0csUUFBSGlELEtBQUFIIiwiZmlsZSI6ImluZGV4Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCByZXN0YXVyYW50cywgbmVpZ2hib3Job29kcywgY3Vpc2luZXM7XG5sZXQgbWFwO1xudmFyIG1hcmtlcnMgPSBbXTtcblxuLyoqXG4gKiBGZXRjaCBuZWlnaGJvcmhvb2RzIGFuZCBjdWlzaW5lcyBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcblx0ZmV0Y2hOZWlnaGJvcmhvb2RzKCk7XG5cdGZldGNoQ3Vpc2luZXMoKTtcbn0pO1xuXG4vKipcbiAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIGFuZCBzZXQgdGhlaXIgSFRNTC5cbiAqL1xubGV0IGZldGNoTmVpZ2hib3Job29kcyA9ICgpID0+IHtcblx0REJIZWxwZXIuZmV0Y2hOZWlnaGJvcmhvb2RzKChlcnJvciwgbmVpZ2hib3Job29kcykgPT4ge1xuXHRcdGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3Jcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRzZWxmLm5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzO1xuXHRcdFx0ZmlsbE5laWdoYm9yaG9vZHNIVE1MKCk7XG5cdFx0XHR2YXIgbmVpZ2hib3Job29kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZCcpO1xuXHRcdFx0dmFyIG5laWdoYm9yaG9vZExpc3RCb3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmVpZ2hib3Job29kLWxpc3Rib3gnKTtcblx0XHRcdG5ldyBDb21ib0JveChuZWlnaGJvcmhvb2QsIG5laWdoYm9yaG9vZExpc3RCb3gpO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vKipcbiAqIFNldCBuZWlnaGJvcmhvb2RzIEhUTUwuXG4gKi9cbmxldCBmaWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xuXHRjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xuXHRuZWlnaGJvcmhvb2RzLmZvckVhY2gobmVpZ2hib3Job29kID0+IHtcblx0XHRjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG5cdFx0bGkuaW5uZXJIVE1MID0gbmVpZ2hib3Job29kO1xuXHRcdGxpLnZhbHVlID0gbmVpZ2hib3Job29kO1xuXHRcdGxpLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJvcHRpb25cIik7XG5cdFx0dWwuYXBwZW5kKGxpKTtcblx0fSk7XG59O1xuXG4vKipcbiAqIEZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXG4gKi9cbmxldCBmZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xuXHREQkhlbHBlci5mZXRjaEN1aXNpbmVzKChlcnJvciwgY3Vpc2luZXMpID0+IHtcblx0XHRpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxuXHRcdFx0Y29uc29sZS5lcnJvcihlcnJvcik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lcztcblx0XHRcdGZpbGxDdWlzaW5lc0hUTUwoKTtcblx0XHRcdHZhciBjdWlzaW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmUnKTtcblx0XHRcdHZhciBjdWlzaW5lTGlzdEJveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lLWxpc3Rib3gnKTtcblx0XHRcdG5ldyBDb21ib0JveChjdWlzaW5lLCBjdWlzaW5lTGlzdEJveCk7XG5cdFx0fVxuXHR9KTtcbn07XG5cbi8qKlxuICogU2V0IGN1aXNpbmVzIEhUTUwuXG4gKi9cbmxldCBmaWxsQ3Vpc2luZXNIVE1MID0gKGN1aXNpbmVzID0gc2VsZi5jdWlzaW5lcykgPT4ge1xuXHRjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcblx0Y3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcblx0XHRjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG5cdFx0bGkuaW5uZXJIVE1MID0gY3Vpc2luZTtcblx0XHRsaS52YWx1ZSA9IGN1aXNpbmU7XG5cdFx0bGkuc2V0QXR0cmlidXRlKCdyb2xlJywgJ29wdGlvbicpO1xuXHRcdHVsLmFwcGVuZChsaSk7XG5cdH0pO1xufTtcblxuLyoqXG4gKiBJbml0aWFsaXplIEdvb2dsZSBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXG4gKi9cbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xuXHRsZXQgbG9jID0ge1xuXHRcdGxhdDogNDAuNzIyMjE2LFxuXHRcdGxuZzogLTczLjk4NzUwMVxuXHR9O1xuXHRzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XG5cdFx0em9vbTogMTIsXG5cdFx0Y2VudGVyOiBsb2MsXG5cdFx0c2Nyb2xsd2hlZWw6IGZhbHNlXG5cdH0pO1xuXHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihzZWxmLm1hcCwgJ3RpbGVzbG9hZGVkJywgZnVuY3Rpb24gKCkge1xuXHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtYXAgaWZyYW1lJykuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0aXRlbS5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgJ0dvb2dsZSBNYXBzJyk7XG5cdFx0fSk7XG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI21hcCAqJykuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0aXRlbS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG5cdFx0fSk7XG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI21hcCBbcmVsPVwibm9vcGVuZXJcIl0nKS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRpdGVtLnJlbW92ZUF0dHJpYnV0ZSgncmVsJyk7XG5cdFx0fSk7XG5cdH0pO1xuXHR1cGRhdGVSZXN0YXVyYW50cygpO1xufTtcblxuLyoqXG4gKiBVcGRhdGUgcGFnZSBhbmQgbWFwIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzLlxuICovXG5sZXQgdXBkYXRlUmVzdGF1cmFudHMgPSAoKSA9PiB7XG5cdGNvbnN0IGN1aXNpbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZScpO1xuXHRjb25zdCBuZWlnaGJvcmhvb2QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kJyk7XG5cblx0REJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKGN1aXNpbmUudmFsdWUsIG5laWdoYm9yaG9vZC52YWx1ZSwgKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXG5cdFx0XHRjb25zb2xlLmVycm9yKGVycm9yKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmVzZXRSZXN0YXVyYW50cyhyZXN0YXVyYW50cyk7XG5cdFx0XHRmaWxsUmVzdGF1cmFudHNIVE1MKCk7XG5cdFx0fVxuXHR9KVxufTtcblxuLyoqXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXG4gKi9cbmxldCByZXNldFJlc3RhdXJhbnRzID0gKHJlc3RhdXJhbnRzKSA9PiB7XG5cdC8vIFJlbW92ZSBhbGwgcmVzdGF1cmFudHNcblx0c2VsZi5yZXN0YXVyYW50cyA9IFtdO1xuXHRjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XG5cdHVsLmlubmVySFRNTCA9ICcnO1xuXG5cdC8vIFJlbW92ZSBhbGwgbWFwIG1hcmtlcnNcblx0c2VsZi5tYXJrZXJzLmZvckVhY2gobSA9PiBtLnNldE1hcChudWxsKSk7XG5cdHNlbGYubWFya2VycyA9IFtdO1xuXHRzZWxmLnJlc3RhdXJhbnRzID0gcmVzdGF1cmFudHM7XG59O1xuXG4vKipcbiAqIENyZWF0ZSBhbGwgcmVzdGF1cmFudHMgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmxldCBmaWxsUmVzdGF1cmFudHNIVE1MID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xuXHRjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XG5cdHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XG5cdFx0dWwuYXBwZW5kKGNyZWF0ZVJlc3RhdXJhbnRIVE1MKHJlc3RhdXJhbnQpKTtcblx0fSk7XG5cdGFkZE1hcmtlcnNUb01hcCgpO1xufTtcblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MLlxuICovXG5sZXQgY3JlYXRlUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCkgPT4ge1xuXHRjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG5cblx0Y29uc3QgaW1nU3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xuXHRpZiAoaW1nU3JjKSB7XG5cdFx0Y29uc3QgcGljdHVyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3BpY3R1cmUnKTtcblxuXHRcdGNvbnN0IHdlYnAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcblx0XHR3ZWJwLnR5cGUgPSAnaW1hZ2Uvd2VicCc7XG5cdFx0d2VicC5zcmNzZXQgPSBEQkhlbHBlci53ZWJwU3Jjc2V0Rm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcblxuXHRcdGNvbnN0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xuXHRcdGltZy50eXBlID0gJ2ltYWdlL2pwZWcnO1xuXHRcdGltZy5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVNyY3NldEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XG5cblx0XHRjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuXHRcdGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XG5cdFx0aW1hZ2Uuc3JjID0gaW1nU3JjO1xuXHRcdGltYWdlLnNyY3NldCA9IERCSGVscGVyLmltYWdlU3Jjc2V0Rm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcblx0XHRpbWFnZS5zaXplcyA9ICcxMDB2dyc7XG5cdFx0aW1hZ2UuYWx0ID0gYEltYWdlIG9mIHJlc3RhdXJhbnQgJHtyZXN0YXVyYW50Lm5hbWV9YDtcblxuXHRcdHBpY3R1cmUuYXBwZW5kQ2hpbGQod2VicCk7XG5cdFx0cGljdHVyZS5hcHBlbmRDaGlsZChpbWcpO1xuXHRcdHBpY3R1cmUuYXBwZW5kQ2hpbGQoaW1hZ2UpO1xuXHRcdGxpLmFwcGVuZChwaWN0dXJlKTtcblx0fVxuXG5cdGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xuXHRuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcblx0bGkuYXBwZW5kKG5hbWUpO1xuXG5cdGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblx0bmVpZ2hib3Job29kLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmVpZ2hib3Job29kO1xuXHRsaS5hcHBlbmQobmVpZ2hib3Job29kKTtcblxuXHRjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuXHRhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcblx0bGkuYXBwZW5kKGFkZHJlc3MpO1xuXG5cdGNvbnN0IG1vcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cdG1vcmUuaW5uZXJIVE1MID0gJ1ZpZXcgRGV0YWlscyc7XG5cdG1vcmUuaHJlZiA9IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XG5cdGxpLmFwcGVuZChtb3JlKTtcblxuXHRyZXR1cm4gbGk7XG59O1xuXG4vKipcbiAqIEFkZCBtYXJrZXJzIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzIHRvIHRoZSBtYXAuXG4gKi9cbmxldCBhZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XG5cdHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XG5cdFx0Ly8gQWRkIG1hcmtlciB0byB0aGUgbWFwXG5cdFx0Y29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XG5cdFx0Z29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCAoKSA9PiB7XG5cdFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9IG1hcmtlci51cmxcblx0XHR9KTtcblx0XHRzZWxmLm1hcmtlcnMucHVzaChtYXJrZXIpO1xuXHR9KTtcbn07Il19
