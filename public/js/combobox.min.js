"use strict";var VK_ENTER=13,VK_ESC=27,VK_UP=38,VK_DOWN=40,LAST_ID=0;function nextId(){var t=":"+LAST_ID;return LAST_ID++,t}function ComboBox(t,e){this.el=t,this.listbox=new ListBox(e,this),e.id=nextId(),this.el.addEventListener("focus",this.handleFocus.bind(this),!0),this.el.addEventListener("blur",this.handleBlur.bind(this),!0),this.el.addEventListener("input",this.handleInput.bind(this)),this.el.addEventListener("keydown",this.handleKeyDown.bind(this))}function ListBox(t,e){this.el=t,this.textbox=e,this.items=Array.prototype.slice.call(t.querySelectorAll("[role=option]"));for(var i=0;i<this.items.length;i++){var s=this.items[i];s.id=nextId(),s.addEventListener("mouseover",this.handleHoverOnItem.bind(this)),s.addEventListener("mousedown",this.handleClickOnItem.bind(this),!0)}this.visibleItems=this.items.slice()}ComboBox.prototype={set value(t){this.el.value=t},showListbox:function(t){this.listbox.show(t),this.el.setAttribute("aria-expanded",!0)},hideListbox:function(){this.listbox.hide(),this.el.setAttribute("aria-expanded",!1),this.el.removeAttribute("aria-activedescendant")},handleFocus:function(t){this.showListbox(t.target)},handleBlur:function(){this.hideListbox()},handleInput:function(t){this.showListbox(t.target),this.listbox.filter(this.el.value)},handleKeyDown:function(t){if(VK_DOWN===t.keyCode)this.listbox.hidden||this.listbox.nextActiveListItem();else if(VK_UP===t.keyCode)this.listbox.hidden||this.listbox.previousActiveListItem();else if(VK_ENTER===t.keyCode){var e=this.listbox.activeItem;e&&(this.setSelected(e),this.hideListbox())}else VK_ESC===t.keyCode&&this.hideListbox()},setSelected:function(t){this.value=t.textContent,updateRestaurants()},setActiveDescendant:function(t){t.id&&this.el.setAttribute("aria-activedescendant",t.id)}},ListBox.prototype={toggle:function(){this.hidden?this.show():this.hide()},get hidden(){return this.el.hasAttribute("hidden")},get activeItem(){return this.el.querySelector("[role=option].active")},filter:function(t){var e=0,i=!0,s=!(this.visibleItems=[]),n=void 0;try{for(var h,o=this.items[Symbol.iterator]();!(i=(h=o.next()).done);i=!0){var a=h.value;a.textContent.toLowerCase().startsWith(t.toLowerCase())?(e++,a.hidden=!1,this.visibleItems.push(a)):(a.hidden=!0,a.classList.remove("active"))}}catch(t){s=!0,n=t}finally{try{!i&&o.return&&o.return()}finally{if(s)throw n}}if(0===e)this.hide();else for(var d=0;d<this.visibleItems.length;d++){var l=this.visibleItems[d];l.setAttribute("aria-posinset",d+1),l.setAttribute("aria-setsize",this.visibleItems.length)}},show:function(t){this.hidden&&(this.el.style.width=t.offsetWidth+"px",this.el.style.left=t.offsetLeft+"px",this.el.removeAttribute("hidden"))},hide:function(){this.hidden||(this.activeItem&&this.activeItem.classList.remove("active"),this.el.setAttribute("hidden",""))},handleHoverOnItem:function(t){var e=this.visibleItems.indexOf(t.target);e<0||this.changeActiveListitem(e)},handleClickOnItem:function(t){var e=t.target;this.items.indexOf(e)<0||(this.textbox.setSelected(e),this.hide())},nextActiveListItem:function(){var t=this.activeItem,e=-1;t&&(e=this.visibleItems.indexOf(t));var i=e;i=(i+1)%this.visibleItems.length,this.changeActiveListitem(i)},previousActiveListItem:function(){var t=this.activeItem,e=-1;t&&(e=this.visibleItems.indexOf(t));var i=e;--i<0&&(i+=this.visibleItems.length),this.changeActiveListitem(i)},changeActiveListitem:function(t){var e=this.activeItem,i=this.visibleItems[t];e&&e.classList.remove("active"),i.classList.add("active"),this.textbox.setActiveDescendant(i)}};