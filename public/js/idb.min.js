"use strict";!function(){function u(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function i(n,o,r){var i,e=new Promise(function(e,t){u(i=n[o].apply(n,r)).then(e,t)});return e.request=i,e}function e(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function t(t,n,o,e){e.forEach(function(e){e in o.prototype&&(t.prototype[e]=function(){return i(this[n],e,arguments)})})}function n(t,n,o,e){e.forEach(function(e){e in o.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function o(e,o,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[o],(t=i(e,n,arguments)).then(function(e){if(e)return new c(e,t.request)});var e,t})})}function r(e){this._index=e}function c(e,t){this._cursor=e,this._request=t}function s(e){this._store=e}function a(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function p(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new a(n)}function f(e){this._db=e}e(r,"_index",["name","keyPath","multiEntry","unique"]),t(r,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),o(r,"_index",IDBIndex,["openCursor","openKeyCursor"]),e(c,"_cursor",["direction","key","primaryKey","value"]),t(c,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(c.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),u(t._request).then(function(e){if(e)return new c(e,t._request)})})})}),s.prototype.createIndex=function(){return new r(this._store.createIndex.apply(this._store,arguments))},s.prototype.index=function(){return new r(this._store.index.apply(this._store,arguments))},e(s,"_store",["name","keyPath","indexNames","autoIncrement"]),t(s,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),o(s,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),n(s,"_store",IDBObjectStore,["deleteIndex"]),a.prototype.objectStore=function(){return new s(this._tx.objectStore.apply(this._tx,arguments))},e(a,"_tx",["objectStoreNames","mode"]),n(a,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new s(this._db.createObjectStore.apply(this._db,arguments))},e(p,"_db",["name","version","objectStoreNames"]),n(p,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new a(this._db.transaction.apply(this._db,arguments))},e(f,"_db",["name","version","objectStoreNames"]),n(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[s,r].forEach(function(e){e.prototype[i.replace("open","iterate")]=function(){var e,t=(e=arguments,Array.prototype.slice.call(e)),n=t[t.length-1],o=this._store||this._index,r=o[i].apply(o,t.slice(0,-1));r.onsuccess=function(){n(r.result)}}})}),[r,s].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var o=this,r=[];return new Promise(function(t){o.iterateCursor(e,function(e){e?(r.push(e.value),void 0===n||r.length!=n?e.continue():t(r)):t(r)})})})});var d={open:function(e,t,n){var o=i(indexedDB,"open",[e,t]),r=o.request;return r.onupgradeneeded=function(e){n&&n(new p(r.result,e.oldVersion,r.transaction))},o.then(function(e){return new f(e)})},delete:function(e){return i(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=d,module.exports.default=module.exports):self.idb=d}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlkYi5qcyJdLCJuYW1lcyI6WyJwcm9taXNpZnlSZXF1ZXN0IiwicmVxdWVzdCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwib25zdWNjZXNzIiwicmVzdWx0Iiwib25lcnJvciIsImVycm9yIiwicHJvbWlzaWZ5UmVxdWVzdENhbGwiLCJvYmoiLCJtZXRob2QiLCJhcmdzIiwicCIsImFwcGx5IiwidGhlbiIsInByb3h5UHJvcGVydGllcyIsIlByb3h5Q2xhc3MiLCJ0YXJnZXRQcm9wIiwicHJvcGVydGllcyIsImZvckVhY2giLCJwcm9wIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJwcm90b3R5cGUiLCJnZXQiLCJ0aGlzIiwic2V0IiwidmFsIiwicHJveHlSZXF1ZXN0TWV0aG9kcyIsIkNvbnN0cnVjdG9yIiwiYXJndW1lbnRzIiwicHJveHlNZXRob2RzIiwicHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyIsInZhbHVlIiwiQ3Vyc29yIiwiSW5kZXgiLCJpbmRleCIsIl9pbmRleCIsIl9jdXJzb3IiLCJjdXJzb3IiLCJjb21wbGV0ZSIsImlkYlRyYW5zYWN0aW9uIiwiVHJhbnNhY3Rpb24iLCJfdHgiLCJEQiIsIm9uYWJvcnQiLCJPYmplY3RTdG9yZSIsIml0ZW1zIiwiZGIiLCJvbGRWZXJzaW9uIiwidHJhbnNhY3Rpb24iLCJfZGIiLCJpbnN0YW5jZSIsIml0ZXJhdGVDdXJzb3IiLCJvcGVuIiwiSURCSW5kZXgiLCJJREJDdXJzb3IiLCJtZXRob2ROYW1lIiwiX3JlcXVlc3QiLCJJREJPYmplY3RTdG9yZSIsImNyZWF0ZUluZGV4IiwiX3N0b3JlIiwiSURCVHJhbnNhY3Rpb24iLCJVcGdyYWRlREIiLCJuYXRpdmVPYmplY3QiLCJmdW5jTmFtZSIsIm9iamVjdFN0b3JlIiwiY3JlYXRlT2JqZWN0U3RvcmUiLCJjb3VudCIsIklEQkRhdGFiYXNlIiwib251cGdyYWRlbmVlZGVkIiwidXBncmFkZUNhbGxiYWNrIiwiZGVsZXRlIiwibW9kdWxlIiwiZGVmYXVsdCIsInJlcGxhY2UiLCJzZWxmIiwiYXJyIiwiaWRiIiwiQXJyYXkiLCJzbGljZSIsImNhbGwiLCJjYWxsYmFjayIsImxlbmd0aCIsImdldEFsbCIsInF1ZXJ5IiwicHVzaCIsInVuZGVmaW5lZCIsImNvbnRpbnVlIiwiZXhwIiwibmFtZSIsInZlcnNpb24iLCJpbmRleGVkREIiLCJldmVudCIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBLGNBRUMsV0FLQSxTQUFTQSxFQUFpQkMsR0FDekIsT0FBTyxJQUFJQyxRQUFRLFNBQVVDLEVBQVNDLEdBQ3JDSCxFQUFRSSxVQUFZLFdBQ25CRixFQUFRRixFQUFRSyxTQUdqQkwsRUFBUU0sUUFBVSxXQUNqQkgsRUFBT0gsRUFBUU8sVUFLbEIsU0FBU0MsRUFBcUJDLEVBQUtDLEVBQVFDLEdBQzFDLElBQUlYLEVBQ0FZLEVBQUksSUFBSVgsUUFBUSxTQUFVQyxFQUFTQyxHQUV0Q0osRUFEQUMsRUFBVVMsRUFBSUMsR0FBUUcsTUFBTUosRUFBS0UsSUFDUEcsS0FBS1osRUFBU0MsS0FJekMsT0FEQVMsRUFBRVosUUFBVUEsRUFDTFksRUFXUixTQUFTRyxFQUFnQkMsRUFBWUMsRUFBWUMsR0FDaERBLEVBQVdDLFFBQVEsU0FBVUMsR0FDNUJDLE9BQU9DLGVBQWVOLEVBQVdPLFVBQVdILEVBQU0sQ0FDakRJLElBQUssV0FDSixPQUFPQyxLQUFLUixHQUFZRyxJQUV6Qk0sSUFBSyxTQUFBQyxHQUNKRixLQUFLUixHQUFZRyxHQUFRTyxPQU03QixTQUFTQyxFQUFvQlosRUFBWUMsRUFBWVksRUFBYVgsR0FDakVBLEVBQVdDLFFBQVEsU0FBVUMsR0FDdEJBLEtBQVFTLEVBQVlOLFlBQzFCUCxFQUFXTyxVQUFVSCxHQUFRLFdBQzVCLE9BQU9aLEVBQXFCaUIsS0FBS1IsR0FBYUcsRUFBTVUsZUFLdkQsU0FBU0MsRUFBYWYsRUFBWUMsRUFBWVksRUFBYVgsR0FDMURBLEVBQVdDLFFBQVEsU0FBVUMsR0FDdEJBLEtBQVFTLEVBQVlOLFlBQzFCUCxFQUFX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QUMvQyxJQUFJaEIsRUFBVzNCLEtBQ1hzQixFQUFRLEdBRVosT0FBTyxJQUFJOUMsUUFBUSxTQUFVQyxHQUM1QmtELEVBQVNDLGNBQWNnQyxFQUFPLFNBQVU5QyxHQUNsQ0EsR0FJTFEsRUFBTXVDLEtBQUsvQyxFQUFPTixZQUVKc0QsSUFBVm5CLEdBQXVCckIsRUFBTW9DLFFBQVVmLEVBSTNDN0IsRUFBT2lELFdBSE50RixFQUFRNkMsSUFOUjdDLEVBQVE2QyxXQWViLElBQUkwQyxFQUFNLENBQ1RuQyxLQUFNLFNBQVVvQyxFQUFNQyxFQUFTcEIsR0FDOUIsSUFBSTNELEVBQUlKLEVBQXFCb0YsVUFBVyxPQUFRLENBQUNGLEVBQU1DLElBQ25EM0YsRUFBVVksRUFBRVosUUFRaEIsT0FOQUEsRUFBUXNFLGdCQUFrQixTQUFVdUIsR0FDL0J0QixHQUNIQSxFQUFnQixJQUFJUixFQUFVL0QsRUFBUUssT0FBUXdGLEVBQU01QyxXQUFZakQsRUFBUWtELGVBSW5FdEMsRUFBRUUsS0FBSyxTQUFVa0MsR0FDdkIsT0FBTyxJQUFJSixFQUFHSSxNQUdoQndCLE9BQVEsU0FBVWtCLEdBQ2pCLE9BQU9sRixFQUFxQm9GLFVBQVcsaUJBQWtCLENBQUNGLE1BSXRDLG9CQUFYakIsUUFDVkEsT0FBT3FCLFFBQVVMLEVBQ2pCaEIsT0FBT3FCLFFBQVFwQixRQUFVRCxPQUFPcUIsU0FHaENsQixLQUFLRSxJQUFNVyxFQWxUWiIsImZpbGUiOiJpZGIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHRmdW5jdGlvbiB0b0FycmF5KGFycikge1xuXHRcdHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KSB7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRyZXNvbHZlKHJlcXVlc3QucmVzdWx0KTtcblx0XHRcdH07XG5cblx0XHRcdHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0cmVqZWN0KHJlcXVlc3QuZXJyb3IpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG5cdFx0dmFyIHJlcXVlc3Q7XG5cdFx0dmFyIHAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRyZXF1ZXN0ID0gb2JqW21ldGhvZF0uYXBwbHkob2JqLCBhcmdzKTtcblx0XHRcdHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuXHRcdH0pO1xuXG5cdFx0cC5yZXF1ZXN0ID0gcmVxdWVzdDtcblx0XHRyZXR1cm4gcDtcblx0fVxuXG5cdGZ1bmN0aW9uIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG5cdFx0dmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncyk7XG5cdFx0cmV0dXJuIHAudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdGlmICghdmFsdWUpIHJldHVybjtcblx0XHRcdHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBwLnJlcXVlc3QpO1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJveHlQcm9wZXJ0aWVzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIHByb3BlcnRpZXMpIHtcblx0XHRwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eUNsYXNzLnByb3RvdHlwZSwgcHJvcCwge1xuXHRcdFx0XHRnZXQ6IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXTtcblx0XHRcdFx0fSxcblx0XHRcdFx0c2V0OiBmdW5jdGlvbiAodmFsKSB7XG5cdFx0XHRcdFx0dGhpc1t0YXJnZXRQcm9wXVtwcm9wXSA9IHZhbDtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRmdW5jdGlvbiBwcm94eVJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG5cdFx0cHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wKSB7XG5cdFx0XHRpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcblx0XHRcdFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRyZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdH1cblxuXHRmdW5jdGlvbiBwcm94eU1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcblx0XHRwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHtcblx0XHRcdGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuXHRcdFx0UHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdLmFwcGx5KHRoaXNbdGFyZ2V0UHJvcF0sIGFyZ3VtZW50cyk7XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuXHRcdHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAocHJvcCkge1xuXHRcdFx0aWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG5cdFx0XHRQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0cmV0dXJuIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKHRoaXNbdGFyZ2V0UHJvcF0sIHByb3AsIGFyZ3VtZW50cyk7XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gSW5kZXgoaW5kZXgpIHtcblx0XHR0aGlzLl9pbmRleCA9IGluZGV4O1xuXHR9XG5cblx0cHJveHlQcm9wZXJ0aWVzKEluZGV4LCAnX2luZGV4JywgW1xuXHRcdCduYW1lJyxcblx0XHQna2V5UGF0aCcsXG5cdFx0J211bHRpRW50cnknLFxuXHRcdCd1bmlxdWUnXG5cdF0pO1xuXG5cdHByb3h5UmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xuXHRcdCdnZXQnLFxuXHRcdCdnZXRLZXknLFxuXHRcdCdnZXRBbGwnLFxuXHRcdCdnZXRBbGxLZXlzJyxcblx0XHQnY291bnQnXG5cdF0pO1xuXG5cdHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xuXHRcdCdvcGVuQ3Vyc29yJyxcblx0XHQnb3BlbktleUN1cnNvcidcblx0XSk7XG5cblx0ZnVuY3Rpb24gQ3Vyc29yKGN1cnNvciwgcmVxdWVzdCkge1xuXHRcdHRoaXMuX2N1cnNvciA9IGN1cnNvcjtcblx0XHR0aGlzLl9yZXF1ZXN0ID0gcmVxdWVzdDtcblx0fVxuXG5cdHByb3h5UHJvcGVydGllcyhDdXJzb3IsICdfY3Vyc29yJywgW1xuXHRcdCdkaXJlY3Rpb24nLFxuXHRcdCdrZXknLFxuXHRcdCdwcmltYXJ5S2V5Jyxcblx0XHQndmFsdWUnXG5cdF0pO1xuXG5cdHByb3h5UmVxdWVzdE1ldGhvZHMoQ3Vyc29yLCAnX2N1cnNvcicsIElEQkN1cnNvciwgW1xuXHRcdCd1cGRhdGUnLFxuXHRcdCdkZWxldGUnXG5cdF0pO1xuXG5cdC8vIHByb3h5ICduZXh0JyBtZXRob2RzXG5cdFsnYWR2YW5jZScsICdjb250aW51ZScsICdjb250aW51ZVByaW1hcnlLZXknXS5mb3JFYWNoKGZ1bmN0aW9uIChtZXRob2ROYW1lKSB7XG5cdFx0aWYgKCEobWV0aG9kTmFtZSBpbiBJREJDdXJzb3IucHJvdG90eXBlKSkgcmV0dXJuO1xuXHRcdEN1cnNvci5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHR2YXIgY3Vyc29yID0gdGhpcztcblx0XHRcdHZhciBhcmdzID0gYXJndW1lbnRzO1xuXHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRjdXJzb3IuX2N1cnNvclttZXRob2ROYW1lXS5hcHBseShjdXJzb3IuX2N1cnNvciwgYXJncyk7XG5cdFx0XHRcdHJldHVybiBwcm9taXNpZnlSZXF1ZXN0KGN1cnNvci5fcmVxdWVzdCkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdFx0XHRpZiAoIXZhbHVlKSByZXR1cm47XG5cdFx0XHRcdFx0cmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIGN1cnNvci5fcmVxdWVzdCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0fSk7XG5cblx0ZnVuY3Rpb24gT2JqZWN0U3RvcmUoc3RvcmUpIHtcblx0XHR0aGlzLl9zdG9yZSA9IHN0b3JlO1xuXHR9XG5cblx0T2JqZWN0U3RvcmUucHJvdG90eXBlLmNyZWF0ZUluZGV4ID0gZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuY3JlYXRlSW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuXHR9O1xuXG5cdE9iamVjdFN0b3JlLnByb3RvdHlwZS5pbmRleCA9IGZ1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcblx0fTtcblxuXHRwcm94eVByb3BlcnRpZXMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBbXG5cdFx0J25hbWUnLFxuXHRcdCdrZXlQYXRoJyxcblx0XHQnaW5kZXhOYW1lcycsXG5cdFx0J2F1dG9JbmNyZW1lbnQnXG5cdF0pO1xuXG5cdHByb3h5UmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuXHRcdCdwdXQnLFxuXHRcdCdhZGQnLFxuXHRcdCdkZWxldGUnLFxuXHRcdCdjbGVhcicsXG5cdFx0J2dldCcsXG5cdFx0J2dldEFsbCcsXG5cdFx0J2dldEtleScsXG5cdFx0J2dldEFsbEtleXMnLFxuXHRcdCdjb3VudCdcblx0XSk7XG5cblx0cHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG5cdFx0J29wZW5DdXJzb3InLFxuXHRcdCdvcGVuS2V5Q3Vyc29yJ1xuXHRdKTtcblxuXHRwcm94eU1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuXHRcdCdkZWxldGVJbmRleCdcblx0XSk7XG5cblx0ZnVuY3Rpb24gVHJhbnNhY3Rpb24oaWRiVHJhbnNhY3Rpb24pIHtcblx0XHR0aGlzLl90eCA9IGlkYlRyYW5zYWN0aW9uO1xuXHRcdHRoaXMuY29tcGxldGUgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRpZGJUcmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9O1xuXHRcdFx0aWRiVHJhbnNhY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0cmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcblx0XHRcdH07XG5cdFx0XHRpZGJUcmFuc2FjdGlvbi5vbmFib3J0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRyZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdFRyYW5zYWN0aW9uLnByb3RvdHlwZS5vYmplY3RTdG9yZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX3R4Lm9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX3R4LCBhcmd1bWVudHMpKTtcblx0fTtcblxuXHRwcm94eVByb3BlcnRpZXMoVHJhbnNhY3Rpb24sICdfdHgnLCBbXG5cdFx0J29iamVjdFN0b3JlTmFtZXMnLFxuXHRcdCdtb2RlJ1xuXHRdKTtcblxuXHRwcm94eU1ldGhvZHMoVHJhbnNhY3Rpb24sICdfdHgnLCBJREJUcmFuc2FjdGlvbiwgW1xuXHRcdCdhYm9ydCdcblx0XSk7XG5cblx0ZnVuY3Rpb24gVXBncmFkZURCKGRiLCBvbGRWZXJzaW9uLCB0cmFuc2FjdGlvbikge1xuXHRcdHRoaXMuX2RiID0gZGI7XG5cdFx0dGhpcy5vbGRWZXJzaW9uID0gb2xkVmVyc2lvbjtcblx0XHR0aGlzLnRyYW5zYWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTtcblx0fVxuXG5cdFVwZ3JhZGVEQi5wcm90b3R5cGUuY3JlYXRlT2JqZWN0U3RvcmUgPSBmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl9kYi5jcmVhdGVPYmplY3RTdG9yZS5hcHBseSh0aGlzLl9kYiwgYXJndW1lbnRzKSk7XG5cdH07XG5cblx0cHJveHlQcm9wZXJ0aWVzKFVwZ3JhZGVEQiwgJ19kYicsIFtcblx0XHQnbmFtZScsXG5cdFx0J3ZlcnNpb24nLFxuXHRcdCdvYmplY3RTdG9yZU5hbWVzJ1xuXHRdKTtcblxuXHRwcm94eU1ldGhvZHMoVXBncmFkZURCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcblx0XHQnZGVsZXRlT2JqZWN0U3RvcmUnLFxuXHRcdCdjbG9zZSdcblx0XSk7XG5cblx0ZnVuY3Rpb24gREIoZGIpIHtcblx0XHR0aGlzLl9kYiA9IGRiO1xuXHR9XG5cblx0REIucHJvdG90eXBlLnRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiBuZXcgVHJhbnNhY3Rpb24odGhpcy5fZGIudHJhbnNhY3Rpb24uYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xuXHR9O1xuXG5cdHByb3h5UHJvcGVydGllcyhEQiwgJ19kYicsIFtcblx0XHQnbmFtZScsXG5cdFx0J3ZlcnNpb24nLFxuXHRcdCdvYmplY3RTdG9yZU5hbWVzJ1xuXHRdKTtcblxuXHRwcm94eU1ldGhvZHMoREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xuXHRcdCdjbG9zZSdcblx0XSk7XG5cblx0Ly8gQWRkIGN1cnNvciBpdGVyYXRvcnNcblx0Ly8gVE9ETzogcmVtb3ZlIHRoaXMgb25jZSBicm93c2VycyBkbyB0aGUgcmlnaHQgdGhpbmcgd2l0aCBwcm9taXNlc1xuXHRbJ29wZW5DdXJzb3InLCAnb3BlbktleUN1cnNvciddLmZvckVhY2goZnVuY3Rpb24gKGZ1bmNOYW1lKSB7XG5cdFx0W09iamVjdFN0b3JlLCBJbmRleF0uZm9yRWFjaChmdW5jdGlvbiAoQ29uc3RydWN0b3IpIHtcblx0XHRcdENvbnN0cnVjdG9yLnByb3RvdHlwZVtmdW5jTmFtZS5yZXBsYWNlKCdvcGVuJywgJ2l0ZXJhdGUnKV0gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHZhciBhcmdzID0gdG9BcnJheShhcmd1bWVudHMpO1xuXHRcdFx0XHR2YXIgY2FsbGJhY2sgPSBhcmdzW2FyZ3MubGVuZ3RoIC0gMV07XG5cdFx0XHRcdHZhciBuYXRpdmVPYmplY3QgPSB0aGlzLl9zdG9yZSB8fCB0aGlzLl9pbmRleDtcblx0XHRcdFx0dmFyIHJlcXVlc3QgPSBuYXRpdmVPYmplY3RbZnVuY05hbWVdLmFwcGx5KG5hdGl2ZU9iamVjdCwgYXJncy5zbGljZSgwLCAtMSkpO1xuXHRcdFx0XHRyZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRjYWxsYmFjayhyZXF1ZXN0LnJlc3VsdCk7XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9KTtcblxuXHQvLyBwb2x5ZmlsbCBnZXRBbGxcblx0W0luZGV4LCBPYmplY3RTdG9yZV0uZm9yRWFjaChmdW5jdGlvbiAoQ29uc3RydWN0b3IpIHtcblx0XHRpZiAoQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCkgcmV0dXJuO1xuXHRcdENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwgPSBmdW5jdGlvbiAocXVlcnksIGNvdW50KSB7XG5cdFx0XHR2YXIgaW5zdGFuY2UgPSB0aGlzO1xuXHRcdFx0dmFyIGl0ZW1zID0gW107XG5cblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuXHRcdFx0XHRpbnN0YW5jZS5pdGVyYXRlQ3Vyc29yKHF1ZXJ5LCBmdW5jdGlvbiAoY3Vyc29yKSB7XG5cdFx0XHRcdFx0aWYgKCFjdXJzb3IpIHtcblx0XHRcdFx0XHRcdHJlc29sdmUoaXRlbXMpO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpdGVtcy5wdXNoKGN1cnNvci52YWx1ZSk7XG5cblx0XHRcdFx0XHRpZiAoY291bnQgIT09IHVuZGVmaW5lZCAmJiBpdGVtcy5sZW5ndGggPT0gY291bnQpIHtcblx0XHRcdFx0XHRcdHJlc29sdmUoaXRlbXMpO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRjdXJzb3IuY29udGludWUoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9KTtcblxuXHR2YXIgZXhwID0ge1xuXHRcdG9wZW46IGZ1bmN0aW9uIChuYW1lLCB2ZXJzaW9uLCB1cGdyYWRlQ2FsbGJhY2spIHtcblx0XHRcdHZhciBwID0gcHJvbWlzaWZ5UmVxdWVzdENhbGwoaW5kZXhlZERCLCAnb3BlbicsIFtuYW1lLCB2ZXJzaW9uXSk7XG5cdFx0XHR2YXIgcmVxdWVzdCA9IHAucmVxdWVzdDtcblxuXHRcdFx0cmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0aWYgKHVwZ3JhZGVDYWxsYmFjaykge1xuXHRcdFx0XHRcdHVwZ3JhZGVDYWxsYmFjayhuZXcgVXBncmFkZURCKHJlcXVlc3QucmVzdWx0LCBldmVudC5vbGRWZXJzaW9uLCByZXF1ZXN0LnRyYW5zYWN0aW9uKSk7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cblx0XHRcdHJldHVybiBwLnRoZW4oZnVuY3Rpb24gKGRiKSB7XG5cdFx0XHRcdHJldHVybiBuZXcgREIoZGIpO1xuXHRcdFx0fSk7XG5cdFx0fSxcblx0XHRkZWxldGU6IGZ1bmN0aW9uIChuYW1lKSB7XG5cdFx0XHRyZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwoaW5kZXhlZERCLCAnZGVsZXRlRGF0YWJhc2UnLCBbbmFtZV0pO1xuXHRcdH1cblx0fTtcblxuXHRpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGV4cDtcblx0XHRtb2R1bGUuZXhwb3J0cy5kZWZhdWx0ID0gbW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0ZWxzZSB7XG5cdFx0c2VsZi5pZGIgPSBleHA7XG5cdH1cbn0oKSk7XG4iXX0=
