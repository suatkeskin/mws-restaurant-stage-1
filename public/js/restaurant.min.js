"use strict";var restaurant=void 0,map=void 0;window.initMap=function(){fetchRestaurantFromURL(function(e,t){e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),google.maps.event.addListener(self.map,"tilesloaded",function(){document.querySelectorAll("#map iframe").forEach(function(e){e.setAttribute("title","Google Maps")}),document.querySelectorAll("#map *").forEach(function(e){e.setAttribute("tabindex","-1")}),document.querySelectorAll('#map [rel="noopener"]').forEach(function(e){e.removeAttribute("rel")})}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})};var fetchRestaurantFromURL=function(r){if(self.restaurant)r(null,self.restaurant);else{var e=getParameterByName("id");e?DBHelper.fetchRestaurants(e,function(e,t){e?console.error(e):(self.restaurant=t,fillRestaurantHTML(),r(null,t))}):r("No restaurant id in URL",null)}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;var t=document.getElementById("restaurant-img-webp-src");t.type="image/webp",t.srcset=DBHelper.webpSrcsetForRestaurant(e);var r=document.getElementById("restaurant-img-jpg-src");r.type="image/jpeg",r.srcset=DBHelper.imageSrcsetForRestaurant(e);var n=DBHelper.imageUrlForRestaurant(e);if(n){var a=document.getElementById("restaurant-img");a.className="restaurant-img",a.src=n,a.srcset=DBHelper.imageSrcsetForRestaurant(e),a.sizes="100vw",a.alt="Image of restaurant "+e.name}else document.getElementById("restaurant-picture").remove();document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var r in e){var n=e[r].split(",");for(var a in n)addRestaurantHoursHTML(t,"0"===a?r:"",n[a])}},addRestaurantHoursHTML=function(e,t,r){var n=document.createElement("tr"),a=document.createElement("td");a.innerHTML=t,n.appendChild(a);var l=document.createElement("td");l.innerHTML=r,n.appendChild(l),e.appendChild(n)},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),r=document.createElement("h4");if(r.innerHTML="Reviews",t.appendChild(r),!e){var n=document.createElement("p");return n.innerHTML="No reviews yet!",void t.appendChild(n)}var a=document.getElementById("reviews-list");e.forEach(function(e){a.appendChild(createReviewHTML(e))}),t.appendChild(a)},createReviewHTML=function(e){var t=document.createElement("li"),r=document.createElement("p");r.innerHTML=e.comments,t.appendChild(r);var n=document.createElement("strong");n.innerHTML=e.name;var a=document.createElement("h5");a.appendChild(n),t.appendChild(a);var l=document.createElement("p");l.classList.add("date"),l.innerHTML=e.date,t.appendChild(l);var i=document.createElement("div");return i.classList.add("rating"),i.classList.add("rating-"+e.rating),t.appendChild(i),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),r=document.createElement("a");r.innerHTML=e.name,r.href="restaurant.html?id="+e.id,r.setAttribute("aria-current","page");var n=document.createElement("li");n.appendChild(r),t.appendChild(n)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnQuanMiXSwibmFtZXMiOlsicmVzdGF1cmFudCIsIm1hcCIsIndpbmRvdyIsImluaXRNYXAiLCJmZXRjaFJlc3RhdXJhbnRGcm9tVVJMIiwiZXJyb3IiLCJzZWxmIiwiZ29vZ2xlIiwibWFwcyIsIk1hcCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjb25zb2xlIiwiY2VudGVyIiwibGF0bG5nIiwic2Nyb2xsd2hlZWwiLCJmb3JFYWNoIiwiaXRlbSIsInNldEF0dHJpYnV0ZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJEQkhlbHBlciIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJjYWxsYmFjayIsImlkIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmlsbFJlc3RhdXJhbnRIVE1MIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiaW5uZXJIVE1MIiwibmFtZSIsImFkZHJlc3MiLCJ3ZWJwIiwidHlwZSIsImltZyIsInNyY3NldCIsIndlYnBTcmNzZXRGb3JSZXN0YXVyYW50IiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJpbWFnZVNyY3NldEZvclJlc3RhdXJhbnQiLCJhbHQiLCJyZW1vdmUiLCJpbWdTcmMiLCJvcGVyYXRpbmdfaG91cnMiLCJmaWxsUmV2aWV3c0hUTUwiLCJmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCIsIm9wZXJhdGluZ0hvdXJzIiwiaG91cnMiLCJ0aW1lcyIsImtleSIsInNwbGl0IiwidGltZUtleSIsImFkZFJlc3RhdXJhbnRIb3Vyc0hUTUwiLCJkYXlEZXRhaWwiLCJ0aW1lRGV0YWlsIiwiY3JlYXRlRWxlbWVudCIsImRheSIsInRpbWUiLCJyb3ciLCJhcHBlbmRDaGlsZCIsInJldmlld3MiLCJ0aXRsZSIsIm5vUmV2aWV3cyIsImNvbnRhaW5lciIsInVsIiwiY3JlYXRlUmV2aWV3SFRNTCIsInJldmlldyIsImxpIiwiY29tbWVudHMiLCJzdHJvbmciLCJkYXRlIiwiY2xhc3NMaXN0IiwiYWRkIiwicmF0aW5nIiwiZmlsbEJyZWFkY3J1bWIiLCJjdXJyZW50UGFnZSIsImJyZWFkY3J1bWIiLCJ1cmwiLCJocmVmIiwiUmVnRXhwIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwicmVzdWx0cyIsInJlcGxhY2UiXSwibWFwcGluZ3MiOiJhQUFBLElBQUlBLGdCQUFBQSxFQUNBQyxTQUFBQSxFQUtKQyxPQUFPQyxRQUFVLFdBQ2hCQyx1QkFBdUIsU0FBQ0MsRUFBT0wsR0FEaENFLEVBQ0NFLFFBQUFBLE1BQUFBLElBQ2NFLEtBQUFMLElBQUEsSUFBQU0sT0FBQUMsS0FBQUMsSUFBQUMsU0FBQUMsZUFBQSxPQUFBLENBQ1pDLEtBQUFBLEdBRERDLE9BRU9iLEVBQUFjLE9BQ05SLGFBQVcsSUFFVk8sT0FBQUEsS0FBUWIsTUFBQUEsWUFGc0RNLEtBQUFMLElBQUEsY0FBQSxXQUc5RGMsU0FBQUEsaUJBQWEsZUFBQUMsUUFBQSxTQUFBQyxHQUhkQSxFQUFBQyxhQUFBLFFBQUEsaUJBTUNSLFNBQVNTLGlCQUFpQixVQUFBSCxRQUFlQSxTQUFRQyxHQUNoREEsRUFBS0MsYUFBYSxXQUFTLFFBRTVCUixTQUFTUyxpQkFBaUIseUJBQWtCSCxRQUFBLFNBQWdCQyxHQUMzREEsRUFBS0MsZ0JBQWEsV0FHbEJELGlCQUNBRyxTQUZEQyx1QkFBQWYsS0FBQU4sV0FBQU0sS0FBQUwsU0FVSixJQUFBRyx1QkFBQSxTQUFBa0IsR0FJQyxHQUFJaEIsS0FBS04sV0FDUnNCLEVBQVMsS0FBTWhCLEtBQUtOLGdCQURyQixDQUF1QixJQUFBdUIsRUFBQUMsbUJBQUEsTUFDdEJGLEVBR0RGLFNBQVdJLGlCQUFBQSxFQUFtQixTQUFuQm5CLEVBQVhMLEdBQ0t1QixFQUFNWCxRQUFBUCxNQUFBQSxJQUFYQyxLQUVPTixXQUFBQSxFQUNOb0IscUJBQ0NFLEVBQUEsS0FBV3RCLE1BUFpzQixFQUFBLDBCQUFBLFFBZUFHLG1CQUFBLFdBQUEsSUFBQXpCLEVBQUEsRUFBQTBCLFVBQUFDLGFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFBcEIs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Q1ksT0FKQU0sRUFBTUosVUFBUzNELElBQUFBLFVBQ2YyRCxFQUFPeEMsVUFBUDJDLElBQUFILFVBQUFILEVBQUFPLFFBQ0FOLEVBQUFSLFlBQWFqRCxHQUVWaUQsR0FrQkFlLGVBQWlCLFdBQWtDLElBQWpDMUUsRUFBaUMsRUFBQTBCLFVBQUFDLGFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFwQnBCLEtBQUtOLFdBWGpDeUUsRUFBUy9ELFNBQVM2QyxlQUF4QixjQUNBa0IsRUFBQS9ELFNBQUE2QyxjQUFBLEtBQ0FrQixFQUFPRixVQUFQdkUsRUFBK0JrRSxLQUMvQkMsRUFBR1IsS0FBSFEsc0JBQUFuRSxFQUFBdUIsR0FhQW9ELEVBQVl6RCxhQUFhLGVBQWdCLFFBWHpDLElBQUFpRCxFQUFBekQsU0FBQTZDLGNBQUEsTUF2QkRZLEVBQUFSLFlBQUFnQixHQXFDQ0MsRUFBV2pCLFlBQVlRLElBTXBCM0MsbUJBQXFCLFNBQUNNLEVBQU0rQyxHQWJ6QkQsSUFDTkMsRUFBTUYsT0FBQUEsU0FBY2pFLE1BQ3BCaUUsRUFBQUEsRUFBWTlDLFFBQUFBLFVBQVk3QixRQUN4QjJFLElBQ0FBLEVBRFlHLElBQVpDLE9BQVlELE9BQVpoRCxFQUFZZ0QscUJBQ0E1RCxLQUFBQSxHQUNaLE9BQU1pRCxFQUVOUyxFQUFXakIsR0FnQkpxQixtQkFBbUJDLEVBQVEsR0FBR0MsUUFBUSxNQUFPLE1BeEJyRCxHQU9JdkIiLCJmaWxlIjoicmVzdGF1cmFudC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudDtcbmxldCBtYXA7XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxuICovXG53aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcblx0ZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcblx0XHRpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxuXHRcdFx0Y29uc29sZS5lcnJvcihlcnJvcik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcblx0XHRcdFx0em9vbTogMTYsXG5cdFx0XHRcdGNlbnRlcjogcmVzdGF1cmFudC5sYXRsbmcsXG5cdFx0XHRcdHNjcm9sbHdoZWVsOiBmYWxzZVxuXHRcdFx0fSk7XG5cdFx0XHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihzZWxmLm1hcCwgJ3RpbGVzbG9hZGVkJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjbWFwIGlmcmFtZScpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0XHRpdGVtLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAnR29vZ2xlIE1hcHMnKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtYXAgKicpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0XHRpdGVtLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNtYXAgW3JlbD1cIm5vb3BlbmVyXCJdJykuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0XHRcdGl0ZW0ucmVtb3ZlQXR0cmlidXRlKCdyZWwnKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHRcdGZpbGxCcmVhZGNydW1iKCk7XG5cdFx0XHREQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHNlbGYucmVzdGF1cmFudCwgc2VsZi5tYXApO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vKipcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cbiAqL1xubGV0IGZldGNoUmVzdGF1cmFudEZyb21VUkwgPSAoY2FsbGJhY2spID0+IHtcblx0aWYgKHNlbGYucmVzdGF1cmFudCkgeyAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcblx0XHRjYWxsYmFjayhudWxsLCBzZWxmLnJlc3RhdXJhbnQpO1xuXHRcdHJldHVybjtcblx0fVxuXHRjb25zdCBpZCA9IGdldFBhcmFtZXRlckJ5TmFtZSgnaWQnKTtcblx0aWYgKCFpZCkgeyAvLyBubyBpZCBmb3VuZCBpbiBVUkxcblx0XHRjYWxsYmFjaygnTm8gcmVzdGF1cmFudCBpZCBpbiBVUkwnLCBudWxsKTtcblx0fSBlbHNlIHtcblx0XHREQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcblx0XHRcdGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0c2VsZi5yZXN0YXVyYW50ID0gcmVzdGF1cmFudDtcblx0XHRcdFx0ZmlsbFJlc3RhdXJhbnRIVE1MKCk7XG5cdFx0XHRcdGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG59O1xuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZVxuICovXG5sZXQgZmlsbFJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcblx0Y29uc3QgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LW5hbWUnKTtcblx0bmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XG5cblx0Y29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWFkZHJlc3MnKTtcblx0YWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XG5cblx0Y29uc3Qgd2VicCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWltZy13ZWJwLXNyYycpO1xuXHR3ZWJwLnR5cGUgPSAnaW1hZ2Uvd2VicCc7XG5cdHdlYnAuc3Jjc2V0ID0gREJIZWxwZXIud2VicFNyY3NldEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XG5cblx0Y29uc3QgaW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaW1nLWpwZy1zcmMnKTtcblx0aW1nLnR5cGUgPSAnaW1hZ2UvanBlZyc7XG5cdGltZy5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVNyY3NldEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XG5cblx0Y29uc3QgaW1nU3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xuXHRpZiAoaW1nU3JjKSB7XG5cdFx0Y29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKTtcblx0XHRpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnO1xuXHRcdGltYWdlLnNyYyA9IGltZ1NyYztcblx0XHRpbWFnZS5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVNyY3NldEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XG5cdFx0aW1hZ2Uuc2l6ZXMgPSAnMTAwdncnO1xuXHRcdGltYWdlLmFsdCA9IGBJbWFnZSBvZiByZXN0YXVyYW50ICR7cmVzdGF1cmFudC5uYW1lfWA7XG5cdH0gZWxzZSB7XG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtcGljdHVyZScpLnJlbW92ZSgpO1xuXHR9XG5cblx0Y29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcblx0Y3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcblxuXHQvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xuXHRpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcblx0XHRmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpO1xuXHR9XG5cdC8vIGZpbGwgcmV2aWV3c1xuXHRmaWxsUmV2aWV3c0hUTUwoKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgb3BlcmF0aW5nIGhvdXJzIEhUTUwgdGFibGUgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cbiAqL1xubGV0IGZpbGxSZXN0YXVyYW50SG91cnNIVE1MID0gKG9wZXJhdGluZ0hvdXJzID0gc2VsZi5yZXN0YXVyYW50Lm9wZXJhdGluZ19ob3VycykgPT4ge1xuXHRjb25zdCBob3VycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWhvdXJzJyk7XG5cdGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xuXHRcdGNvbnN0IHRpbWVzID0gb3BlcmF0aW5nSG91cnNba2V5XS5zcGxpdCgnLCcpO1xuXHRcdGZvciAobGV0IHRpbWVLZXkgaW4gdGltZXMpIHtcblx0XHRcdGlmICh0aW1lS2V5ID09PSAnMCcpIHtcblx0XHRcdFx0YWRkUmVzdGF1cmFudEhvdXJzSFRNTChob3Vycywga2V5LCB0aW1lc1t0aW1lS2V5XSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRhZGRSZXN0YXVyYW50SG91cnNIVE1MKGhvdXJzLCAnJywgdGltZXNbdGltZUtleV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcblxubGV0IGFkZFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAoaG91cnMsIGRheURldGFpbCwgdGltZURldGFpbCkgPT4ge1xuXHRjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuXHRjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuXHRkYXkuaW5uZXJIVE1MID0gZGF5RGV0YWlsO1xuXHRyb3cuYXBwZW5kQ2hpbGQoZGF5KTtcblxuXHRjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcblx0dGltZS5pbm5lckhUTUwgPSB0aW1lRGV0YWlsO1xuXHRyb3cuYXBwZW5kQ2hpbGQodGltZSk7XG5cdGhvdXJzLmFwcGVuZENoaWxkKHJvdyk7XG59O1xuXG4vKipcbiAqIENyZWF0ZSBhbGwgcmV2aWV3cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cbiAqL1xubGV0IGZpbGxSZXZpZXdzSFRNTCA9IChyZXZpZXdzID0gc2VsZi5yZXN0YXVyYW50LnJldmlld3MpID0+IHtcblx0Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJyk7XG5cdGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDQnKTtcblx0dGl0bGUuaW5uZXJIVE1MID0gJ1Jldmlld3MnO1xuXHRjb250YWluZXIuYXBwZW5kQ2hpbGQodGl0bGUpO1xuXG5cdGlmICghcmV2aWV3cykge1xuXHRcdGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblx0XHRub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISc7XG5cdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKG5vUmV2aWV3cyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpO1xuXHRyZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcblx0XHR1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpO1xuXHR9KTtcblx0Y29udGFpbmVyLmFwcGVuZENoaWxkKHVsKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYiBwYWdlLlxuICovXG5sZXQgY3JlYXRlUmV2aWV3SFRNTCA9IChyZXZpZXcpID0+IHtcblx0Y29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuXG5cdGNvbnN0IGNvbW1lbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuXHRjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHM7XG5cdGxpLmFwcGVuZENoaWxkKGNvbW1lbnRzKTtcblxuXHRjb25zdCBzdHJvbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHJvbmcnKTtcblx0c3Ryb25nLmlubmVySFRNTCA9IHJldmlldy5uYW1lO1xuXHRjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDUnKTtcblx0bmFtZS5hcHBlbmRDaGlsZChzdHJvbmcpO1xuXHRsaS5hcHBlbmRDaGlsZChuYW1lKTtcblxuXHRjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuXHRkYXRlLmNsYXNzTGlzdC5hZGQoXCJkYXRlXCIpO1xuXHRkYXRlLmlubmVySFRNTCA9IHJldmlldy5kYXRlO1xuXHRsaS5hcHBlbmRDaGlsZChkYXRlKTtcblxuXHRjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0cmF0aW5nLmNsYXNzTGlzdC5hZGQoXCJyYXRpbmdcIik7XG5cdHJhdGluZy5jbGFzc0xpc3QuYWRkKGByYXRpbmctJHtyZXZpZXcucmF0aW5nfWApO1xuXHRsaS5hcHBlbmRDaGlsZChyYXRpbmcpO1xuXG5cdHJldHVybiBsaTtcbn07XG5cbi8qKlxuICogQWRkIHJlc3RhdXJhbnQgbmFtZSB0byB0aGUgYnJlYWRjcnVtYiBuYXZpZ2F0aW9uIG1lbnVcbiAqL1xubGV0IGZpbGxCcmVhZGNydW1iID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcblx0Y29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XG5cdGNvbnN0IGN1cnJlbnRQYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuXHRjdXJyZW50UGFnZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XG5cdGN1cnJlbnRQYWdlLmhyZWYgPSBgcmVzdGF1cmFudC5odG1sP2lkPSR7cmVzdGF1cmFudC5pZH1gO1xuXHRjdXJyZW50UGFnZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWN1cnJlbnRcIiwgXCJwYWdlXCIpO1xuXHRjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG5cdGxpLmFwcGVuZENoaWxkKGN1cnJlbnRQYWdlKTtcblx0YnJlYWRjcnVtYi5hcHBlbmRDaGlsZChsaSk7XG59O1xuXG4vKipcbiAqIEdldCBhIHBhcmFtZXRlciBieSBuYW1lIGZyb20gcGFnZSBVUkwuXG4gKi9cbmxldCBnZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XG5cdGlmICghdXJsKVxuXHRcdHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuXHRuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJyk7XG5cdGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgWz8mXSR7bmFtZX0oPShbXiYjXSopfCZ8I3wkKWApLFxuXHRcdHJlc3VsdHMgPSByZWdleC5leGVjKHVybCk7XG5cdGlmICghcmVzdWx0cylcblx0XHRyZXR1cm4gbnVsbDtcblx0aWYgKCFyZXN1bHRzWzJdKVxuXHRcdHJldHVybiAnJztcblx0cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcbn07XG4iXX0=
